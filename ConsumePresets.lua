-- ============================================================================
-- SLACKSPOTTER - CONSUME PRESETS (COMPACT FORMAT)
-- Format: "Raid|Spec|ID1,ID2,ID3|anyX" or "Raid|Spec|ID1,ID2|" (empty = check all)
-- ============================================================================

SS_ConsumePresets_Compact = {
    -- ========================================================================
    -- MOLTEN CORE (MC)
    -- ========================================================================
    "MC|WarriorDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "MC|WarriorTank|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any1",
--    "MC|PaladinRetri||any1",
--    "MC|PaladinHoly||any1",
--    "MC|PaladinTank||any1",
    "MC|HunterSurv|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "MC|HunterMM||2,10,11,13,27,41,42,43,44,61,62,72,73|any1",
    "MC|ShamanEnhDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "MC|ShamanEle (Nat)|1,10,11,12,20,21,22,25,40,41,43,48,60,61,62|any1",
    "MC|ShamanEle (Fire)|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any1",
    "MC|ShamanResto|3,10,11,12,20,21,41,43,48,49,60,61,62|any1",
    "MC|ShamanEnhTank|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any1",
    "MC|RogueDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "MC|DruidCat|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "MC|DruidOwl|1,10,11,12,20,21,22,25,32,40,41,43,48,60,61,62|any1",
    "MC|DruidTree|3,10,11,12,20,21,41,43,48,49,60,61,62|any1",
    "MC|DruidBear|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any1",
    "MC|PriestDisc|1,10,11,12,20,21,22,40,41,43,48,60,61,62|any1",
    "MC|PriestShadow|1,10,11,12,20,21,22,23,40,41,43,48,60,61,62|any1",
    "MC|PriestHoly|3,10,11,12,20,21,41,43,48,49,60,61,62|any1",
    "MC|WarlockShadow|1,10,11,12,20,21,22,23,40,41,43,48,60,61,62|any1",
    "MC|WarlockFire|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any1",
    "MC|MageArcane|1,10,11,12,20,21,22,32,40,41,43,48,60,61,62|any1",
    "MC|MageFire|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any1",
    "MC|MageFrost|1,10,11,12,20,21,22,26,40,41,43,48,60,61,62|any1",
    
    -- ========================================================================
    -- BLACKWING LAIR (BWL)
    -- ========================================================================
    "BWL|WarriorDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "BWL|WarriorTank|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any1",
--    "BWL|PaladinRetri||any1",
--    "BWL|PaladinHoly||any1",
--    "BWL|PaladinTank||any1",
    "BWL|HunterSurv|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "BWL|HunterMM||2,10,11,13,27,41,42,43,44,61,62,72,73|any1",
    "BWL|ShamanEnhDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "BWL|ShamanEle (Nat)|1,10,11,12,20,21,22,25,40,41,43,48,60,61,62|any1",
    "BWL|ShamanEle (Fire)|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any1",
    "BWL|ShamanResto|3,10,11,12,20,21,41,43,48,49,60,61,62|any1",
    "BWL|ShamanEnhTank|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any1",
    "BWL|RogueDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "BWL|DruidCat|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "BWL|DruidOwl|1,10,11,12,20,21,22,25,32,40,41,43,48,60,61,62|any1",
    "BWL|DruidTree|3,10,11,12,20,21,41,43,48,49,60,61,62|any1",
    "BWL|DruidBear|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any1",
    "BWL|PriestDisc|1,10,11,12,20,21,22,40,41,43,48,60,61,62|any1",
    "BWL|PriestShadow|1,10,11,12,20,21,22,23,40,41,43,48,60,61,62|any1",
    "BWL|PriestHoly|3,10,11,12,20,21,41,43,48,49,60,61,62|any1",
    "BWL|WarlockShadow|1,10,11,12,20,21,22,23,40,41,43,48,60,61,62|any1",
    "BWL|WarlockFire|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any1",
    "BWL|MageArcane|1,10,11,12,20,21,22,32,40,41,43,48,60,61,62|any1",
    "BWL|MageFire|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any1",
    "BWL|MageFrost|1,10,11,12,20,21,22,26,40,41,43,48,60,61,62|any1",
    
    -- ========================================================================
    -- NAXXRAMAS (Naxx)
    -- ========================================================================all 1 melhunt 2 cast 2 heal2
    "Naxx|WarriorDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any3",
    "Naxx|WarriorTank|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any3",
--    "Naxx|PaladinRetri||any1",
--    "Naxx|PaladinHoly||any1",
--    "Naxx|PaladinTank||any1",
    "Naxx|HunterSurv|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any3",
    "Naxx|HunterMM||2,10,11,13,27,41,42,43,44,61,62,72,73|any3",
    "Naxx|ShamanEnhDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any3",
    "Naxx|ShamanEle (Nat)|1,10,11,12,20,21,22,25,40,41,43,48,60,61,62|any3",
    "Naxx|ShamanEle (Fire)|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any3",
    "Naxx|ShamanResto|3,10,11,12,20,21,41,43,48,49,60,61,62|any3",
    "Naxx|ShamanEnhTank|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any3",
    "Naxx|RogueDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any3",
    "Naxx|DruidCat|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any3",
    "Naxx|DruidOwl|1,10,11,12,20,21,22,25,32,40,41,43,48,60,61,62|any3",
    "Naxx|DruidTree|3,10,11,12,20,21,41,43,48,49,60,61,62|any3",
    "Naxx|DruidBear|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any3",
    "Naxx|PriestDisc|1,10,11,12,20,21,22,40,41,43,48,60,61,62|any3",
	"Naxx|PriestShadow|1,10,11,12,20,21,22,23,40,41,43,48,60,61,62|any3",
    "Naxx|PriestHoly|3,10,11,12,20,21,41,43,48,49,60,61,62|any3",
    "Naxx|WarlockShadow|1,10,11,12,20,21,22,23,40,41,43,48,60,61,62|any3",
    "Naxx|WarlockFire|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any3",
    "Naxx|MageArcane|1,10,11,12,20,21,22,32,40,41,43,48,60,61,62|any3",
    "Naxx|MageFire|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any3",
    "Naxx|MageFrost|1,10,11,12,20,21,22,26,40,41,43,48,60,61,62|any3",
    
    -- ========================================================================
    -- KARAZHAN 40 (Kara40)
    -- ========================================================================
    "Kara40|WarriorDPS|2,10,11,13,14,27,28,41,43,44,45,71,72,73|",
    "Kara40|WarriorTank|2,10,11,13,14,27,28,29,41,43,44,45,47,61,62,71,72,73|",
--    "Kara40|PaladinRetri||any1",
--    "Kara40|PaladinHoly||any1",
--    "Kara40|PaladinTank||any1",
    "Kara40|HunterSurv|2,10,11,13,14,27,28,41,43,44,45,71,72,73|",
    "Kara40|HunterMM||2,10,11,13,14,27,28,41,42,43,44,71,72,73|",
    "Kara40|ShamanEnhDPS|2,10,11,13,14,27,28,41,43,44,45,71,72,73|",
    "Kara40|ShamanEle (Nat)|1,10,11,20,21,22,25,40,41,43,48|",
    "Kara40|ShamanEle (Fire)|1,10,11,20,21,22,24,40,41,43,48|",
    "Kara40|ShamanResto|3,10,11,20,21,41,43,48,49|",
    "Kara40|ShamanEnhTank|2,10,11,13,14,27,28,29,41,43,44,45,47,61,62,71,72,73|",
    "Kara40|RogueDPS|2,10,11,13,14,27,28,41,43,44,45,71,72,73|",
    "Kara40|DruidCat|2,10,11,13,14,27,28,41,43,44,45,71,72,73|",
    "Kara40|DruidOwl|1,10,11,20,21,22,25,32,40,41,43,48|",
    "Kara40|DruidTree|3,10,11,20,21,41,43,48,49|",
    "Kara40|DruidBear|2,10,11,13,14,27,28,29,41,43,44,45,47,61,62,71,72,73|",
    "Kara40|PriestDisc|1,10,11,20,21,22,40,41,43,48|",
    "Kara40|PriestShadow|1,10,11,20,21,22,23,40,41,43,48|",
    "Kara40|PriestHoly|3,10,11,20,21,41,43,48,49|",
    "Kara40|WarlockShadow|1,10,11,20,21,22,23,40,41,43,48|",
    "Kara40|WarlockFire|1,10,11,20,21,22,24,40,41,43,48|",
    "Kara40|MageArcane|1,10,11,20,21,22,32,40,41,43,48|",
    "Kara40|MageFire|1,10,11,20,21,22,24,40,41,43,48|",
    "Kara40|MageFrost|1,10,11,20,21,22,26,40,41,43,48|",
	
    -- ========================================================================
    -- AQ40 (AQ40)
    -- ========================================================================
    "AQ40|WarriorDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "AQ40|WarriorTank|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any1",
--    "AQ40|PaladinRetri||any1",
--    "AQ40|PaladinHoly||any1",
--    "AQ40|PaladinTank||any1",
    "AQ40|HunterSurv|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "AQ40|HunterMM||2,10,11,13,27,41,42,43,44,61,62,72,73|any1",
    "AQ40|ShamanEnhDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "AQ40|BWLShamanEle (Nat)|1,10,11,12,20,21,22,25,40,41,43,48,60,61,62|any1",
    "AQ40|ShamanEle (Fire)|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any1",
    "AQ40|ShamanResto|3,10,11,12,20,21,41,43,48,49,60,61,62|any1",
    "AQ40|ShamanEnhTank|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any1",
    "AQ40|RogueDPS|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "AQ40|DruidCat|2,10,11,13,14,27,28,41,43,44,45,46,61,62,71,72,73|any1",
    "AQ40|DruidOwl|1,10,11,12,20,21,22,25,32,40,41,43,48,60,61,62|any1",
    "AQ40|DruidTree|3,10,11,12,20,21,41,43,48,49,60,61,62|any1",
    "AQ40|DruidBear|2,10,11,13,14,27,28,29,31,41,43,44,45,47,61,62,71,72,73|any1",
    "AQ40|PriestDisc|1,10,11,12,20,21,22,40,41,43,48,60,61,62|any1",
    "AQ40|PriestShadow|1,10,11,12,20,21,22,23,40,41,43,48,60,61,62|any1",
    "AQ40|PriestHoly|3,10,11,12,20,21,41,43,48,49,60,61,62|any1",
    "AQ40|WarlockShadow|1,10,11,12,20,21,22,23,40,41,43,48,60,61,62|any1",
    "AQ40|WarlockFire|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any1",
    "AQ40|MageArcane|1,10,11,12,20,21,22,32,40,41,43,48,60,61,62|any1",
    "AQ40|MageFire|1,10,11,12,20,21,22,24,40,41,43,48,60,61,62|any1",
    "AQ40|MageFrost|1,10,11,12,20,21,22,26,40,41,43,48,60,61,62|any1",
    
    -- ========================================================================
    -- KARAZHAN 10 (Kara10) - TODO
    -- ========================================================================
    -- "Kara10|WarriorDPS||",
    
    -- ========================================================================
    -- EMERALD SANCTUM (ES) - TODO
    -- ========================================================================
    -- "ES|WarriorDPS||",
    
    -- ========================================================================
    -- AQ20 - TODO
    -- ========================================================================
    -- "AQ20|WarriorDPS||",
    
    -- ========================================================================
    -- ZULGURUB (ZG) - TODO
    -- ========================================================================
    -- "ZG|WarriorDPS||",
    
    -- ========================================================================
    -- ONYXIA (Ony) - TODO
    -- ========================================================================
    -- "Ony|WarriorDPS||",
}

-- ============================================================================
-- PARSER: Convert compact format to full structure
-- ============================================================================

function SS_ConsumePresets_Parse()
    local parsed = {}
    
    for i = 1, table.getn(SS_ConsumePresets_Compact) do
        local line = SS_ConsumePresets_Compact[i]
        
        -- Split by |
        local parts = {}
        for part in string.gfind(line, "[^|]+") do
            table.insert(parts, part)
        end
        
        if table.getn(parts) >= 3 then
            local raid = parts[1]
            local spec = parts[2]
            local consumeIDs = parts[3]
            local minReq = parts[4] or ""
            
            -- Parse consume IDs
            local consumes = {}
            if consumeIDs and consumeIDs ~= "" then
                for idStr in string.gfind(consumeIDs, "[^,]+") do
                    local id = tonumber(idStr)
                    if id and SS_ConsumeData_IDMapping[id] then
                        table.insert(consumes, SS_ConsumeData_IDMapping[id])
                    else
                        DEFAULT_CHAT_FRAME:AddMessage("|cffff0000Preset error: Unknown consume ID " .. (idStr or "nil") .. " in " .. raid .. "/" .. spec .. "|r")
                    end
                end
            end
            
            -- Parse minRequired
            local minRequired = 0
            if minReq and minReq ~= "" then
                local anyNum = string.match(minReq, "any(%d+)")
                if anyNum then
                    minRequired = tonumber(anyNum) or 0
                end
            end
            
            -- Store in parsed structure
            if not parsed[raid] then
                parsed[raid] = {}
            end
            
            parsed[raid][spec] = {
                consumes = consumes,
                minRequired = minRequired
            }
        end
    end
    
    return parsed
end

-- Parse on load
SS_ConsumePresets = SS_ConsumePresets_Parse()